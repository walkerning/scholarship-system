/*
    *
    * Wijmo Library 5.20171.300
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';var u=function(){function i(){}return i.save=function(n,t,i){var r=this._saveFlexGridToWorkbook(n,t);return i&&r.save(i),r},i.saveAsync=function(n,t,i,r,u){var f=this._saveFlexGridToWorkbook(n,t);return f.saveAsync(i,r,u),f},i.load=function(t,i,r){var e=this,u,f;if(i instanceof Blob)u=new FileReader,u.onload=function(){var f=n.xlsx.Workbook._base64EncArr(new Uint8Array(u.result)),i=new n.xlsx.Workbook;i.load(f);f=null;t.deferUpdate(function(){e._loadToFlexGrid(t,i,r);i=null})},u.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)t.deferUpdate(function(){e._loadToFlexGrid(t,i,r);i=null});else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';f=new n.xlsx.Workbook;f.load(i);i=null;t.deferUpdate(function(){e._loadToFlexGrid(t,f,r);f=null})}},i.loadAsync=function(t,i,r,u,f){var o=this,e,s;if(i instanceof Blob)e=new FileReader,e.onload=function(){var i=n.xlsx.Workbook._base64EncArr(new Uint8Array(e.result)),s=new n.xlsx.Workbook;s.loadAsync(i,function(n){i=null;s=null;t.deferUpdate(function(){o._loadToFlexGrid(t,n,r);u&&u(n);n=null})},f)},e.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)t.deferUpdate(function(){o._loadToFlexGrid(t,i,r);u&&u(i);i=null});else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';s=new n.xlsx.Workbook;s.loadAsync(i,function(n){i=null;t.deferUpdate(function(){o._loadToFlexGrid(t,n,r);u&&u(n);n=null})},f)}},i._saveFlexGridToWorkbook=function(i,r){var it=new n.xlsx.Workbook,c=new n.xlsx.WorkSheet,et=new n.xlsx.WorkbookStyle,rt=new n.xlsx.WorkbookFrozenPane,ot=r&&r.includeColumnHeaders!=null?r.includeColumnHeaders:!0,nt=r&&r.includeRowHeaders!=null?r.includeRowHeaders:!1,w=r&&r.includeCellStyles!=null?r.includeCellStyles:!0,lt=r?r.activeWorksheet:null,a=r?r.includeColumns:null,d=r?r.formatItem:null,e,v,b,y,p,o,st,u,s,f,ut,l,g,ht,k,ft=0,tt=0,ct=0,h=0;if(ut=i.wj_sheetInfo,c.name=r?r.sheetName:'',c.visible=r?r.sheetVisible!==!1:!0,st={borders:{top:{style:n.xlsx.BorderStyle.Thin,color:'#D4D4D4'},left:{style:n.xlsx.BorderStyle.Thin,color:'#D4D4D4'},bottom:{style:n.xlsx.BorderStyle.Thin,color:'#D4D4D4'},right:{style:n.xlsx.BorderStyle.Thin,color:'#D4D4D4'}}},et._deserialize(st),c.style=et,o=[],!ut&&(w||d)&&(l=document.createElement('div'),l.style.visibility='hidden',l.setAttribute(t.FlexGrid._WJS_MEASURE,'true'),i.hostElement.appendChild(l)),nt){for(s=0,u=0;u<i.rowHeaders.rows.length;u++)if(!(i.rowHeaders.rows[u].renderSize<=0)){for(o[s]=[],f=0;f<i.rowHeaders.columns.length;f++)b=i._getBindingColumn(i.rowHeaders,u,i.rowHeaders.columns[f]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),o[s][f]=y,s===0&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p,f));s++}h=f}if(ot&&i.columnHeaders.rows.length>0){for(s=0,u=0;u<i.columnHeaders.rows.length;u++)if(!(i.columnHeaders.rows[u].renderSize<=0)){for(o[s]||(o[s]=[]),f=0;f<i.columnHeaders.columns.length;f++)b=i._getBindingColumn(i.columnHeaders,u,i.columnHeaders.columns[f]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),o[s][h+f]=y,s===0&&(!a||a(b))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));h=0;e={};v=new n.xlsx.WorkbookRow;nt&&(h=this._parseFlexGridRowToSheetRow(i.topLeftCells,e,u,0,o,w,l,!1,0,a));this._parseFlexGridRowToSheetRow(i.columnHeaders,e,u,h,o,w,l,!1,0,a);e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,s));s++}tt=s}else for(o[0]||(o[0]=[]),f=0;f<i.columnHeaders.columns.length;f++)b=i._getBindingColumn(i.columnHeaders,0,i.columnHeaders.columns[f]),y=this._getColumnSetting(b,i.columnHeaders.columns.defaultSize),o[0][h+f]=y,(!a||a(b))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));for(u=0;u<i.cells.rows.length;u++)(h=0,e={},v=new n.xlsx.WorkbookRow,g=i.rows[u],g instanceof t._NewRowTemplate)||(k=g instanceof t.GroupRow,k&&(ht=n.tryCast(g,t.GroupRow),ft=ht.level+1),nt&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,w,l,k,ft,a,d)),this._parseFlexGridRowToSheetRow(i.cells,e,u,h,o,w,l,k,ft,a,d),e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,tt+u)));for(ct=i.cells.rows.length,u=0;u<i.columnFooters.rows.length;u++)h=0,e={},v=new n.xlsx.WorkbookRow,g=i.columnFooters.rows[u],k=g instanceof t.GroupRow,nt&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,w,l,k,0,a,d)),this._parseFlexGridRowToSheetRow(i.columnFooters,e,u,h,o,w,l,k,0,a,d),e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,tt+ct+u));return rt.rows=ot?i.frozenRows+tt:i.frozenRows,rt.columns=nt?i.frozenColumns+h:i.frozenColumns,c.frozenPane=rt,it._addWorkSheet(c),!ut&&(w||d)&&i.hostElement.removeChild(l),it.activeWorksheet=lt,it},i._loadToFlexGrid=function(i,r,u){var ui=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,b=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,pt=u&&u.sheetIndex!=null&&!isNaN(u.sheetIndex)?u.sheetIndex:0,dt=u?u.sheetName:null,fi=u?u.sheetVisible:!0,gt=i.wj_sheetInfo!=null,e=0,s=0,w,rt,y,ut,d,k,ft,wt,tt,ni,o,c,ti,g,et,h,ot,st,ii,bt,a,ht,nt,p,l,f,v,kt,ct,lt,ri,it,at=!1,vt={},yt;if(i.itemsSource=null,i.columns.clear(),i.rows.clear(),i.frozenColumns=0,i.frozenRows=0,v={},kt={},s=0,ut=[],ct=[],pt<0||pt>=r.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(dt!=null)for(w=0;w<r.sheets.length;w++)if(dt===r.sheets[w].name){c=r.sheets[w];break}if(c=c||r.sheets[pt],c.rows!=null){for(ui&&(s=1,c.rows.length<=1&&(b=!1,s=0),wt=c.rows[0]),g=this._getColumnCount(c.rows),ti=this._getRowCount(c.rows,g),ii=c.summaryBelow,y=c.columns,e=0;e<g;e++)i.columns.push(new t.Column),!y[e]||(isNaN(+y[e].width)||(i.columns[e].width=+y[e].width),y[e].visible||y[e].visible==undefined||(i.columns[e].visible=!!y[e].visible),y[e].style&&!!y[e].style.wordWrap&&(i.columns[e].wordWrap=y[e].style.wordWrap));for(;s<ti;s++){if(et=!1,yt=!0,o=c.rows[s],o)for(ot=s+1;ot<c.rows.length;)if(st=c.rows[ot],st){(isNaN(o.groupLevel)&&!isNaN(st.groupLevel)||!isNaN(o.groupLevel)&&o.groupLevel<st.groupLevel)&&(et=!0);break}else ot++;for(et&&!ii?(a&&(a.isCollapsed=at),a=new t.GroupRow,a.isReadOnly=!1,at=o.collapsed==null?!1:o.collapsed,a.level=isNaN(o.groupLevel)?0:o.groupLevel,vt[a.level]=at,this._checkParentCollapsed(vt,a.level)&&a._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(a)):(bt=new t.Row,o&&this._checkParentCollapsed(vt,o.groupLevel)&&bt._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(bt)),!o||!o.height||isNaN(o.height)||(i.rows[b?s-1:s].height=o.height),e=0;e<g;e++)if(o){if(h=o.cells[e],p=h?h.formula:undefined,p&&p[0]!=='='&&(p='='+p),p=p?this._parseToFlexSheetFormula(p):undefined,i.setCellData(b?s-1:s,e,p&&gt?p:this._getItemValue(h)),et||this._setColumn(ut,e,h),l=s*g+e,f=h?h.style:undefined,lt=n.xlsx.Workbook._parseExcelFormat(h),f){if(yt=yt&&!!f.wordWrap,ri=this._getItemType(h),f.hAlign)it=n.xlsx.Workbook._parseHAlignToString(n.asEnum(f.hAlign,n.xlsx.HAlign));else switch(ri){case n.DataType.Number:it='right';break;case n.DataType.Boolean:it='center';break;default:it=lt&&lt.search(/[n,c,p]/i)===0?'right':'left'}v[l]={fontWeight:f.font&&f.font.bold?'bold':'none',fontStyle:f.font&&f.font.italic?'italic':'none',textDecoration:f.font&&f.font.underline?'underline':'none',textAlign:it,fontFamily:f.font&&f.font.family?f.font.family:'',fontSize:f.font&&f.font.size?f.font.size+'px':'',color:f.font&&f.font.color?f.font.color:'',backgroundColor:f.fill&&f.fill.color?f.fill.color:'',whiteSpace:f.wordWrap?'pre-wrap':'normal',format:lt};f.borders&&(f.borders.left&&(this._parseBorderStyle(f.borders.left.style,'Left',v[l]),v[l].borderLeftColor=f.borders.left.color),f.borders.right&&(this._parseBorderStyle(f.borders.right.style,'Right',v[l]),v[l].borderRightColor=f.borders.right.color),f.borders.top&&(this._parseBorderStyle(f.borders.top.style,'Top',v[l]),v[l].borderTopColor=f.borders.top.color),f.borders.bottom&&(this._parseBorderStyle(f.borders.bottom.style,'Bottom',v[l]),v[l].borderBottomColor=f.borders.bottom.color));f.font&&ct.indexOf(f.font.family)===-1&&ct.push(f.font.family)}if(h&&n.isNumber(h.rowSpan)&&h.rowSpan>0&&n.isNumber(h.colSpan)&&h.colSpan>0&&(h.rowSpan>1||h.colSpan>1))for(w=s;w<s+h.rowSpan;w++)for(rt=e;rt<e+h.colSpan;rt++)l=w*g+rt,kt[l]=new t.CellRange(s,e,s+h.rowSpan-1,e+h.colSpan-1)}else i.setCellData(b?s-1:s,e,''),this._setColumn(ut,e,undefined);o&&(this._checkParentCollapsed(vt,o.groupLevel)||o.visible||o.visible==undefined||(i.rows[b?s-1:s].visible=o.visible),i.rows[b?s-1:s].wordWrap=!!o.style&&!!o.style.wordWrap||yt)}for(a&&(a.isCollapsed=at),c.frozenPane&&(ht=c.frozenPane.columns,n.isNumber(ht)&&!isNaN(ht)&&(i.frozenColumns=ht),nt=c.frozenPane.rows,n.isNumber(nt)&&!isNaN(nt)&&(i.frozenRows=b&&nt>0?nt-1:nt)),e=0;e<i.columnHeaders.columns.length;e++)d=ut[e],k=i.columns[e],k.isRequired=!1,b?(tt=wt?wt.cells[e]:undefined,tt&&tt.value?(ni=n.xlsx.Workbook._parseExcelFormat(tt),ft=n.Globalize.format(tt.value,ni)):ft=this._numAlpha(e)):ft=this._numAlpha(e),k.header=ft,d&&(d.dataType===n.DataType.Boolean&&(k.dataType=d.dataType),k.format=d.format,k.align=d.hAlign,k.wordWrap=k.wordWrap||d.wordWrap);gt&&(i.wj_sheetInfo.name=c.name,i.wj_sheetInfo.visible=fi===!0?!0:c.visible!==!1,i.wj_sheetInfo.styledCells=v,i.wj_sheetInfo.mergedRanges=kt,i.wj_sheetInfo.fonts=ct)}},i._parseFlexGridRowToSheetRow=function(i,u,f,e,o,s,h,c,l,a,v){var g,b,it,y,ft,p,w,d,nt,ht,et,pt,rt,tt,lt,at,ct,k,bt=!1,vt,ot,kt,yt,wt,ut,st,dt;for(g=i.grid,ct=g.wj_sheetInfo,b=i.rows[f],kt=b.recordIndex!=null?b.recordIndex:0,u.cells||(u.cells=[]),u.visible=b.isVisible,u.height=b.renderHeight||i.rows.defaultSize,u.groupLevel=c?l-1:l,c&&(u.collapsed=b.isCollapsed),b.wordWrap&&(u.style={wordWrap:b.wordWrap}),(b.constructor===n.grid.Row||b.constructor===n.grid._NewRowTemplate||n.grid.detail&&b.constructor===n.grid.detail.DetailRow||n.grid.multirow&&b.constructor===n.grid.multirow._MultiRow)&&(bt=!0),y=0;y<i.columns.length;y++)if(ft=null,at=1,lt=1,ot=!1,rt=null,st=null,vt=g._getBindingColumn(i,f,i.columns[y]),tt=null,ct&&i===g.cells?(pt=f*i.columns.length+y,ct.mergedRanges&&(tt=ct.mergedRanges[pt]),ct.styledCells&&(rt=ct.styledCells[pt])):s&&(ut=h.cloneNode(),h.parentElement.appendChild(ut),s&&(rt=this._getCellStyle(i,ut,f,y)||{})),tt||(tt=g.getMergedRange(i,f,y,!1)),tt?f===tt.topRow&&y===tt.leftCol&&(lt=tt.bottomRow-tt.topRow+1,at=this._getColSpan(i,tt,a),ot=!0):ot=!0,!a||a(vt)){if(it=o[kt][y+e],bt||c?(w=ot?i.getCellData(f,y,!0):null,d=ot?i.getCellData(f,y,!1):null,ht=!1,w&&n.isString(w)&&w.length>1&&w[0]==='='&&(ht=!0),k=n.isDate(d),rt&&rt.format?(ft=rt.format,p=n.xlsx.Workbook._parseCellFormat(rt.format,k)):it&&it.style&&it.style.format?(ft=vt.format,p=it.style.format):p=null,p||(k?p='m/d/yyyy':n.isNumber(d)&&!vt.dataMap?p=n.isInt(d)?'#,##0':'#,##0.00':ht?(et=w.toLowerCase(),et==='=now()'?(p='m/d/yyyy h:mm',k=!0):et==='=today()'||et.substring(0,et.indexOf('('))==='=date'?(p='m/d/yyyy',k=!0):et.substring(0,et.indexOf('('))==='=time'&&(p='h:mm AM/PM',k=!0)):p='General')):(w=ot?g.columnHeaders.getCellData(0,y,!0):null,p='General'),st=this._parseCellStyle(rt)||{},i===g.cells&&c&&b.hasChildren&&y===g.columns.firstVisibleIndex){if(w?nt=w:ot&&(nt=b.getGroupHeader().replace(/<\/?\w+>/g,'')),nt==null&&!rt)continue;k=n.isDate(nt);!k&&ft&&ft.toLowerCase()==='d'&&n.isInt(nt)&&(p='0');nt=typeof nt=='string'?n.xlsx.Workbook._unescapeXML(nt):nt;yt={value:nt,isDate:k,formula:ht?this._parseToExcelFormula(w,k):null,colSpan:at,rowSpan:lt,style:this._extend(st,{format:p,font:{bold:!0},hAlign:n.xlsx.HAlign.Left,indent:l-1})}}else w=typeof w=='string'?n.xlsx.Workbook._unescapeXML(w):w,d=typeof d=='string'?n.xlsx.Workbook._unescapeXML(d):d,!k&&ft&&ft.toLowerCase()==='d'&&n.isInt(d)&&(p='0'),dt=st&&st.hAlign?st.hAlign:it&&it.style&&it.style.hAlign!=null?n.asEnum(it.style.hAlign,n.xlsx.HAlign,!0):n.isDate(d)?n.xlsx.HAlign.Left:n.xlsx.HAlign.General,yt={value:ht?undefined:p==='General'?w:d,isDate:k,formula:ht?this._parseToExcelFormula(w,k):null,colSpan:y<g.columns.firstVisibleIndex?1:at,rowSpan:lt,style:this._extend(st,{format:p,hAlign:dt,vAlign:lt>1?i===g.cells?n.xlsx.VAlign.Top:n.xlsx.VAlign.Center:null})};v&&(wt=new r(i,new t.CellRange(f,y),ut,h,yt),v(wt),ut=wt.cell);ut&&(ut.parentElement.removeChild(ut),ut=null);u.cells.push(yt)}return e+y},i._parseCellStyle=function(t){var i,u,e,r,f;return t==null?null:(i=t.fontSize,i=i?+i.substring(0,i.indexOf('px')):null,isNaN(i)&&(i=null),u=t.fontWeight,u=u==='bold'||+u>=700,e=t.fontStyle==='italic',r=t.textDecorationStyle,r==null&&(r=t.textDecoration),r=r==='underline',f=t.whiteSpace,f=f?f.indexOf('pre')>-1?!0:!1:!1,{font:{bold:u,italic:e,underline:r,family:this._parseToExcelFontFamily(t.fontFamily),size:i,color:t.color},fill:{color:t.backgroundColor},borders:this._parseBorder(t),hAlign:n.xlsx.Workbook._parseStringToHAlign(t.textAlign),wordWrap:f})},i._parseBorder=function(n){var t={};return t.left=this._parseEgdeBorder(n,'Left'),t.right=this._parseEgdeBorder(n,'Right'),t.top=this._parseEgdeBorder(n,'Top'),t.bottom=this._parseEgdeBorder(n,'Bottom'),t},i._parseEgdeBorder=function(t,i){var r,u=t['border'+i+'Style'];if(u&&u!=='none'&&u!=='hidden'){r={};u=u.toLowerCase();switch(u){case'dotted':r.style=n.xlsx.BorderStyle.Dotted;break;case'dashed':r.style=n.xlsx.BorderStyle.Dashed;break;case'double':r.style=n.xlsx.BorderStyle.Double;break;default:r.style=n.xlsx.BorderStyle.Thin}r.color=t['border'+i+'Color']}return r},i._parseBorderStyle=function(t,i,r){var u='border'+i+'Style',f='border'+i+'Width';switch(t){case n.xlsx.BorderStyle.Dotted:case n.xlsx.BorderStyle.Hair:r[u]='dotted';r[f]='1px';break;case n.xlsx.BorderStyle.Dashed:case n.xlsx.BorderStyle.ThinDashDotDotted:case n.xlsx.BorderStyle.ThinDashDotted:r[u]='dashed';r[f]='1px';break;case n.xlsx.BorderStyle.MediumDashed:case n.xlsx.BorderStyle.MediumDashDotDotted:case n.xlsx.BorderStyle.MediumDashDotted:case n.xlsx.BorderStyle.SlantedMediumDashDotted:r[u]='dashed';r[f]='2px';break;case n.xlsx.BorderStyle.Double:r[u]='double';r[f]='3px';break;case n.xlsx.BorderStyle.Medium:r[u]='solid';r[f]='2px';break;default:r[u]='solid';r[f]='1px'}},i._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},i._parseToExcelFormula=function(t,i){var f=t.substring(1,t.indexOf('(')).toLowerCase(),r,u;switch(f){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':u=t.search(/\,\s*\"/);r=t.substring(u,t.lastIndexOf('\"'));r=n.xlsx.Workbook._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,u)+', \"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var f=t.substring(1).match(/\W+(\w+)\(/),r,e,o,s,i,u;e=f&&f.length===2?f[1]:t.substring(1,t.indexOf('('));o=t.indexOf(e);switch(e.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(o);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);s=i.indexOf('0')>-1?0:'';u=n.xlsx.Workbook._parseExcelFormat({value:s,style:{format:i}});u=u.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,o)+r.substring(0,r.indexOf('\"')+1)+u+t.substring(t.indexOf(i)+i.length)}return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.Workbook._parseCellFormat(t.format,t.dataType===n.DataType.Date):'',hAlign:n.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(t.getAlignment())),wordWrap:t.wordWrap}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(t){for(var f=0,i=0,r,u=0;u<t.length;u++)r=t[u]&&t[u].cells?t[u].cells:[],r&&r.length>0&&(i=r.length,n.isInt(r[i-1].colSpan)&&r[i-1].colSpan>1&&(i=i+r[i-1].colSpan-1),i>f&&(f=i));return f},i._getRowCount=function(t,i){for(var f=t.length,u=f-1,o=0,e,s,r;o<i;o++)n:for(;u>=0;u--)if(e=t[u],s=e&&e.cells?e.cells:[],r=s[o],r&&(r.value!=null&&r.value!==''||n.isInt(r.rowSpan)&&r.rowSpan>1)){n.isInt(r.rowSpan)&&r.rowSpan>1&&u+r.rowSpan>f&&(f=u+r.rowSpan);break n}return f},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&u.dataType===n.DataType.Boolean&&f!==n.DataType.Boolean&&(u.dataType=f),r&&r.value!=null&&r.value!==''&&(e=n.xlsx.Workbook._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e)),r&&r.style&&(r.style.hAlign&&(o=n.xlsx.Workbook._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),u.wordWrap=u.wordWrap&&!!r.style.wordWrap),o||f!==n.DataType.Number||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.Workbook._parseExcelFormat(r),hAlign:'',wordWrap:!0}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{n.grid.cellFactory.updateCell(n,i,r,t);t.className=t.className.replace('wj-state-selected','');t.className=t.className.replace('wj-state-multi-selected','')}catch(u){return null}return window.getComputedStyle(t)},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},i}(),r;i.FlexGridXlsxConverter=u;r=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e._cell=r,e._patternCell=u,e._xlsxCell=f,e}return __extends(t,n),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(n){this._xlsxCell=n},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this._patternCell.parentElement.appendChild(this._cell),u._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},t}(n.grid.CellRangeEventArgs);i.XlsxFormatItemEventArgs=r})(i=t.xlsx||(t.xlsx={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))